# ginger
用golang实现的文件存储系统

# 功能
+ 账号管理
+ 会话管理
+ 文件上传
  - 大文件
+ 文件下载
+ 文件管理

### 账号管理
用户表设计:user

|属性|类型|说明|
|----|---|---|
|Id|int|自增主键|
|Username|string|用户名|
|Password|string|密码|
|CreateTime|string|创建时间|
|Auth|int|权限|

### 会话管理
会话表设计:session

|属性|类型|说明|
|----|---|---|
|UserId|int|外键,关联user表|
|SessionId|string|会话id|
|CreateTime|string|创建时间|
|ExpireTime|string|过期时间|
|EndTime|string|结束时间|

### 文件上传

##### 客户端
总体上采用分块传输来适应大文件传输的场景。

+ 客户端会根据文件大小对文件进行分片
+ 对每一个文件块进行编号
+ 包装成请求发送给服务端

##### 服务端
服务端会接收到的请求进行解析:
+ 文件暂存
+ 是否收到全部的文件块
+ 文件校验
+ 文件存储
+ 文件备份

几种响应状态:  
正确(文件块)  
校验通过(文件)  
校验失败(文件)  

##### 服务端执行流程
![image](https://gingerhhc.oss-cn-hangzhou.aliyuncs.com/%E4%B8%8A%E4%BC%A0.png)
1. 请求接收者接收http请求，将请求转化为任务存储在任务队列中
2. 任务调度者会维护当前活跃任务列表，将失败的任务回滚，将成功的任务清除
3. 任务执行者向任务调度者发起询问，任务调度者会根据当前活跃任务列表和任务队列进行任务调度，选择应当执行的任务返回
4. 任务执行者执行任务
5. 任务执行者将结果发送给结果解析者
6. 结果解析者进行判断结果，更新当前活跃任务列表，并返回给客户端结果